// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ //
//   __    __   ______   ______  ______   __   __  __     //
//  /\ "-./  \ /\  __ \ /\__  _\/\  == \ /\ \ /\_\_\_\    //
//  \ \ \-./\ \\ \  __ \\/_/\ \/\ \  __< \ \ \\/_/\_\/_   //
//   \ \_\ \ \_\\ \_\ \_\  \ \_\ \ \_\ \_\\ \_\ /\_\/\_\  //
//    \/_/  \/_/ \/_/\/_/   \/_/  \/_/ /_/ \/_/ \/_/\/_/  //
//                                                        //
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ //
// math/matrix.c

#include "math/matrix.h"

void mat4_copy(mat4_t mat, mat4_t out)
{
    out[0][0] = mat[0][0];
    out[0][1] = mat[0][1];
    out[0][2] = mat[0][2];
    out[0][3] = mat[0][3];

    out[1][0] = mat[1][0];
    out[1][1] = mat[1][1];
    out[1][2] = mat[1][2];
    out[1][3] = mat[1][3];

    out[2][0] = mat[2][0];
    out[2][1] = mat[2][1];
    out[2][2] = mat[2][2];
    out[2][3] = mat[2][3];

    out[3][0] = mat[3][0];
    out[3][1] = mat[3][1];
    out[3][2] = mat[3][2];
    out[3][3] = mat[3][3];
}

void mat4_mul(mat4_t m1, mat4_t m2, mat4_t out)
{
    mat4_t a, b;

    mat4_copy(m1, a);
    mat4_copy(m2, b);

    out[0][0] = a[0][0] * b[0][0] + a[1][0] * b[0][1] + a[2][0] * b[0][2] + a[3][0] * b[0][3];
    out[0][1] = a[0][1] * b[0][0] + a[1][1] * b[0][1] + a[2][1] * b[0][2] + a[3][1] * b[0][3];
    out[0][2] = a[0][2] * b[0][0] + a[1][2] * b[0][1] + a[2][2] * b[0][2] + a[3][2] * b[0][3];
    out[0][3] = a[0][3] * b[0][0] + a[1][3] * b[0][1] + a[2][3] * b[0][2] + a[3][3] * b[0][3];
    out[1][0] = a[0][0] * b[1][0] + a[1][0] * b[1][1] + a[2][0] * b[1][2] + a[3][0] * b[1][3];
    out[1][1] = a[0][1] * b[1][0] + a[1][1] * b[1][1] + a[2][1] * b[1][2] + a[3][1] * b[1][3];
    out[1][2] = a[0][2] * b[1][0] + a[1][2] * b[1][1] + a[2][2] * b[1][2] + a[3][2] * b[1][3];
    out[1][3] = a[0][3] * b[1][0] + a[1][3] * b[1][1] + a[2][3] * b[1][2] + a[3][3] * b[1][3];
    out[2][0] = a[0][0] * b[2][0] + a[1][0] * b[2][1] + a[2][0] * b[2][2] + a[3][0] * b[2][3];
    out[2][1] = a[0][1] * b[2][0] + a[1][1] * b[2][1] + a[2][1] * b[2][2] + a[3][1] * b[2][3];
    out[2][2] = a[0][2] * b[2][0] + a[1][2] * b[2][1] + a[2][2] * b[2][2] + a[3][2] * b[2][3];
    out[2][3] = a[0][3] * b[2][0] + a[1][3] * b[2][1] + a[2][3] * b[2][2] + a[3][3] * b[2][3];
    out[3][0] = a[0][0] * b[3][0] + a[1][0] * b[3][1] + a[2][0] * b[3][2] + a[3][0] * b[3][3];
    out[3][1] = a[0][1] * b[3][0] + a[1][1] * b[3][1] + a[2][1] * b[3][2] + a[3][1] * b[3][3];
    out[3][2] = a[0][2] * b[3][0] + a[1][2] * b[3][1] + a[2][2] * b[3][2] + a[3][2] * b[3][3];
    out[3][3] = a[0][3] * b[3][0] + a[1][3] * b[3][1] + a[2][3] * b[3][2] + a[3][3] * b[3][3];
}

void mat4_scale(float s, mat4_t out)
{
    out[0][0] = s;
    out[1][1] = s;
    out[2][2] = 0;
}

void mat4_translate(float xy[2], mat4_t out)
{
    out[3][0] = xy[0];
    out[3][1] = xy[1];
    out[3][2] = 0;
}

void mat4_orthographic(float left, float right, float bottom, float top, mat4_t out)
{
    out[0][0] = 2 / (right - left);
    out[1][1] = 2 / (top - bottom);
    out[2][2] = -1;
    out[3][0] = -(right + left) / (right - left);
    out[3][1] = -(top + bottom) / (top - bottom);
}

void mat4_zero(mat4_t out) { mat4_copy(MAT4_ZERO, out); }

void mat4_identity(mat4_t out) { mat4_copy(MAT4_IDENTITY, out); }
